<!DOCTYPE html>
<html lang="ko">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Day-Con : Daily Construction</title>
    <style>
        /* [Design System & CSS Variables] */
        :root {
            /* ë¸Œëœë“œ ì»¬ëŸ¬ë¥¼ ì‹ ë¢°ê° ì£¼ëŠ” ê±´ì„¤ ì „ë¬¸ ë¸”ë£¨ í†¤ìœ¼ë¡œ ìœ ì§€ */
            --primary-color: #2563EB; 
            --primary-hover: #1D4ED8;
            --bg-color: #F3F4F6;
            --card-bg: #FFFFFF;
            --text-main: #1F2937;
            --text-sub: #6B7280;
            --border-color: #E5E7EB;
            --success-color: #10B981;
            --danger-color: #EF4444;
            --font-family: 'Pretendard', -apple-system, BlinkMacSystemFont, system-ui, Roboto, sans-serif;
        }

        /* [Reset & Base Styles] */
        * { box-sizing: border-box; margin: 0; padding: 0; }
        body {
            font-family: var(--font-family);
            background-color: var(--bg-color);
            color: var(--text-main);
            line-height: 1.6;
        }

        /* [Header] */
        header {
            background-color: var(--card-bg);
            border-bottom: 1px solid var(--border-color);
            padding: 1rem 2rem;
            display: flex;
            justify-content: space-between;
            align-items: center;
            position: sticky;
            top: 0;
            z-index: 100;
            box-shadow: 0 2px 4px rgba(0,0,0,0.05);
        }
        .logo {
            font-size: 1.5rem;
            font-weight: 800;
            color: var(--primary-color);
            letter-spacing: -0.5px;
            display: flex;
            align-items: center;
            gap: 8px;
        }
        .logo span { color: var(--text-main); }
        .logo .subtitle {
            font-size: 0.8rem;
            font-weight: 500;
            color: var(--text-sub);
            margin-left: 0.5rem;
            padding-left: 0.5rem;
            border-left: 2px solid var(--border-color);
        }
        .user-profile { font-size: 0.9rem; color: var(--text-sub); }

        /* [Layout] */
        .container {
            max-width: 1024px;
            margin: 2rem auto;
            padding: 0 1rem;
        }

        /* [Dashboard Widget Section] */
        .dashboard-grid {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(250px, 1fr));
            gap: 1rem;
            margin-bottom: 2rem;
        }
        .card {
            background: var(--card-bg);
            padding: 1.5rem;
            border-radius: 12px;
            border: 1px solid var(--border-color);
            box-shadow: 0 1px 3px rgba(0,0,0,0.05);
        }
        .card h3 { font-size: 0.85rem; color: var(--text-sub); margin-bottom: 0.5rem; text-transform: uppercase; }
        .card .value { font-size: 1.5rem; font-weight: 700; color: var(--text-main); }
        .weather-info { display: flex; align-items: center; gap: 0.5rem; }

        /* [Main Form Section] */
        .form-section {
            background: var(--card-bg);
            border-radius: 16px;
            padding: 2rem;
            box-shadow: 0 4px 6px -1px rgba(0, 0, 0, 0.1);
        }
        .section-title {
            font-size: 1.25rem;
            font-weight: 700;
            margin-bottom: 1.5rem;
            border-bottom: 2px solid var(--bg-color);
            padding-bottom: 0.5rem;
        }

        .input-group {
            display: grid;
            grid-template-columns: 1fr 1fr;
            gap: 1.5rem;
            margin-bottom: 1.5rem;
        }
        
        @media (max-width: 768px) {
            .input-group { grid-template-columns: 1fr; }
            .logo .subtitle { display: none; } /* ëª¨ë°”ì¼ì—ì„œëŠ” ì„œë¸Œíƒ€ì´í‹€ ìˆ¨ê¹€ */
        }

        .form-control { display: flex; flex-direction: column; gap: 0.5rem; }
        label { font-size: 0.9rem; font-weight: 600; color: var(--text-main); }
        input, select, textarea {
            padding: 0.75rem;
            border: 1px solid var(--border-color);
            border-radius: 8px;
            font-size: 1rem;
            transition: all 0.2s;
        }
        input:focus, select:focus, textarea:focus {
            outline: none;
            border-color: var(--primary-color);
            box-shadow: 0 0 0 3px rgba(37, 99, 235, 0.1);
        }
        textarea { resize: vertical; min-height: 100px; }

        /* [File Upload] */
        .upload-area {
            border: 2px dashed var(--border-color);
            border-radius: 12px;
            padding: 2rem;
            text-align: center;
            cursor: pointer;
            transition: 0.3s;
            background-color: #FAFAFA;
        }
        .upload-area:hover { border-color: var(--primary-color); background-color: #EFF6FF; }
        .upload-icon { font-size: 2rem; margin-bottom: 0.5rem; }
        .upload-text { color: var(--text-sub); font-size: 0.9rem; }

        /* [Action Button] */
        .btn-submit {
            width: 100%;
            padding: 1rem;
            background-color: var(--primary-color);
            color: white;
            border: none;
            border-radius: 8px;
            font-size: 1.1rem;
            font-weight: 700;
            cursor: pointer;
            transition: background 0.3s;
            margin-top: 1rem;
        }
        .btn-submit:hover { background-color: var(--primary-hover); }
        .btn-submit:disabled { background-color: var(--text-sub); cursor: not-allowed; }

        /* [Loading Modal] */
        #loading-overlay {
            display: none;
            position: fixed;
            top: 0; left: 0; width: 100%; height: 100%;
            background: rgba(255, 255, 255, 0.9);
            z-index: 999;
            justify-content: center;
            align-items: center;
            flex-direction: column;
        }
        .spinner {
            width: 50px; height: 50px;
            border: 5px solid var(--border-color);
            border-top: 5px solid var(--primary-color);
            border-radius: 50%;
            animation: spin 1s linear infinite;
            margin-bottom: 1rem;
        }
        @keyframes spin { 0% { transform: rotate(0deg); } 100% { transform: rotate(360deg); } }

    </style>
</head>
<body>

    <!-- Header: Day-Con ë¸Œëœë“œ ì ìš© -->
    <header>
        <div class="logo">
            Day-<span>Con</span>
            <div class="subtitle">Daily Construction</div>
        </div>
        <div class="user-profile">
            ğŸ‘¤ ê´€ë¦¬ì: <strong>ê¹€ê´‘ìš´ (ê±´ì¶• CMíŒ€)</strong>
        </div>
    </header>

    <div class="container">
        
        <!-- Dashboard Widgets -->
        <div class="dashboard-grid">
            <div class="card">
                <h3>TODAY</h3>
                <div class="value" id="current-date">-</div>
            </div>
            <div class="card">
                <h3>WEATHER (OpenWeather)</h3>
                <div class="value weather-info">
                    <span id="weather-icon">â˜€ï¸</span>
                    <span id="weather-text">ë§‘ìŒ 18Â°C</span>
                </div>
            </div>
            <div class="card">
                <h3>PROJECT D-DAY</h3>
                <div class="value" style="color: var(--primary-color);">D-124</div>
            </div>
        </div>

        <!-- Main Input Form -->
        <section class="form-section">
            <h2 class="section-title">ğŸ“ Day-Con ìŠ¤ë§ˆíŠ¸ í˜„ì¥ ë¦¬í¬íŠ¸</h2>
            
            <!-- 1. ê¸°ë³¸ ì •ë³´ -->
            <div class="input-group">
                <div class="form-control">
                    <label for="project_name">í˜„ì¥ëª… / ê³µì‚¬ëª…</label>
                    <input type="text" id="project_name" value="ê´‘ìš´ëŒ€ ì—­ì„¸ê¶Œ ê°œë°œì‚¬ì—… Aêµ¬ì—­" readonly>
                </div>
                <div class="form-control">
                    <label for="manager_name">ì‘ì„±ì</label>
                    <input type="text" id="manager_name" value="ê¹€ê´‘ìš´" placeholder="ì´ë¦„ ì…ë ¥">
                </div>
            </div>

            <!-- 2. ì‘ì—… ì •ë³´ -->
            <div class="input-group">
                <div class="form-control">
                    <label for="work_keyword">ì£¼ìš” ì‘ì—…ëª… (í‚¤ì›Œë“œ)</label>
                    <input type="text" id="work_keyword" placeholder="ì˜ˆ: 3ì¸µ ìŠ¬ë˜ë¸Œ íƒ€ì„¤, ê°±í¼ ì¸ì–‘">
                </div>
                <div class="form-control">
                    <label for="location">ì‘ì—… ìœ„ì¹˜ (êµ¬ì—­/ì¸µ)</label>
                    <input type="text" id="location" placeholder="ì˜ˆ: 101ë™ 3F, Grid 4-5">
                </div>
            </div>

            <div class="input-group">
                <div class="form-control">
                    <label for="workers">ì‘ì—… ì¸ì› (ì§ì¢…ë³„)</label>
                    <input type="text" id="workers" placeholder="ì˜ˆ: ëª©ê³µ 5ëª…, ì² ê·¼ 4ëª…, ë³´í†µì¸ë¶€ 2ëª…">
                </div>
                <div class="form-control">
                    <label for="equipment">ì‚¬ìš© ì¥ë¹„</label>
                    <input type="text" id="equipment" placeholder="ì˜ˆ: 25í†¤ í¬ë ˆì¸ 1ëŒ€, íŒí”„ì¹´ 1ëŒ€">
                </div>
            </div>

            <!-- 3. ìì¬ ë° íŠ¹ì´ì‚¬í•­ -->
            <div class="form-control" style="margin-bottom: 1.5rem;">
                <label for="materials">ì…ê³ /ì‚¬ìš© ìì¬</label>
                <input type="text" id="materials" placeholder="ì˜ˆ: ë ˆë¯¸ì½˜ 25-24-150 30ëŒ€, HD13 ì² ê·¼ 5í†¤">
            </div>

            <div class="form-control" style="margin-bottom: 1.5rem;">
                <label for="special_note">íŠ¹ì´ì‚¬í•­ ë° ìœ„í—˜ìš”ì¸ (ìŒì„±ì…ë ¥ ëŒ€ì²´ ê°€ëŠ¥)</label>
                <textarea id="special_note" placeholder="í˜„ì¥ íŠ¹ì´ì‚¬í•­, ì•ˆì „ ì‚¬ê³  ìœ„í—˜ ìš”ì¸, ë¯¼ì› ë°œìƒ ë“±ì„ ì…ë ¥í•˜ì„¸ìš”."></textarea>
            </div>

            <!-- 4. ì‚¬ì§„ ì—…ë¡œë“œ (OCR/AI ë¶„ì„ìš©) -->
            <div class="form-control" style="margin-bottom: 2rem;">
                <label>í˜„ì¥ ì‚¬ì§„ (ì§„ì²™ë¥  í™•ì¸ ë° OCR ë¶„ì„ìš©)</label>
                <div class="upload-area" id="drop-zone">
                    <div class="upload-icon">ğŸ“¸</div>
                    <div class="upload-text">í´ë¦­í•˜ì—¬ ì‚¬ì§„ ì—…ë¡œë“œ ë˜ëŠ” íŒŒì¼ì„ ì—¬ê¸°ë¡œ ë“œë˜ê·¸í•˜ì„¸ìš”.<br>(Day-Con AIê°€ ì´ë¯¸ì§€ë¥¼ ë¶„ì„í•˜ì—¬ ë‚´ìš©ì„ ìë™ ë³´ì™„í•©ë‹ˆë‹¤)</div>
                    <input type="file" id="file-input" multiple style="display: none;">
                </div>
            </div>

            <button type="button" class="btn-submit" onclick="register()">
                âœ¨ AI ë³´ê³ ì„œ ìë™ ìƒì„± (Generate)
            </button>
        </section>
    </div>

    <!-- Loading Overlay -->
    <div id="loading-overlay">
        <div class="spinner"></div>
        <h3>Day-Con AIê°€ í˜„ì¥ ë°ì´í„°ë¥¼ ë¶„ì„í•˜ê³  ìˆìŠµë‹ˆë‹¤...</h3>
        <p>ì‘ì—…ì¼ì§€, ì•ˆì „ì¼ì§€, í’ˆì§ˆë³´ê³ ì„œë¥¼ ìƒì„± ì¤‘ì…ë‹ˆë‹¤.</p>
    </div>

    <!-- JAVASCRIPT LOGIC -->
    <script>
        // ============================================================
        // [1] Configuration & Constants
        // ============================================================
        // ë°±ì—”ë“œ API ì£¼ì†Œ (í˜„ì¬ ë¹„ì›Œë‘ , ì¶”í›„ ì‹¤ì œ ì„œë²„ ì£¼ì†Œ ì…ë ¥ í•„ìš”)
        const SERVER_URL = ""; 

        // ============================================================
        // [2] Helper Functions (UI Initialization)
        // ============================================================
        document.addEventListener('DOMContentLoaded', () => {
            // ì˜¤ëŠ˜ ë‚ ì§œ ìë™ ì„¸íŒ…
            const today = new Date();
            const dateStr = today.toISOString().split('T')[0];
            document.getElementById('current-date').innerText = dateStr;

            // íŒŒì¼ ì—…ë¡œë“œ UI ì¸í„°ë™ì…˜
            const dropZone = document.getElementById('drop-zone');
            const fileInput = document.getElementById('file-input');

            dropZone.addEventListener('click', () => fileInput.click());
            fileInput.addEventListener('change', (e) => {
                if(e.target.files.length > 0) {
                    dropZone.style.borderColor = 'var(--primary-color)';
                    dropZone.querySelector('.upload-text').innerText = 
                        `ğŸ“¸ ${e.target.files.length}ê°œì˜ íŒŒì¼ì´ ì„ íƒë˜ì—ˆìŠµë‹ˆë‹¤.`;
                }
            });
        });

        // ============================================================
        // [3] Core Logic: register() Function
        // ============================================================
        async function register() {
            // 1. UI Loading í‘œì‹œ ì‹œì‘
            const loadingOverlay = document.getElementById('loading-overlay');
            loadingOverlay.style.display = 'flex';

            // 2. Input ë°ì´í„° ìˆ˜ì§‘ (DOM ìš”ì†Œì—ì„œ ê°’ ê°€ì ¸ì˜¤ê¸°)
            const inputData = {
                project_info: {
                    project_name: document.getElementById('project_name').value,
                    manager: document.getElementById('manager_name').value,
                    date: document.getElementById('current-date').innerText
                },
                work_details: {
                    keyword: document.getElementById('work_keyword').value,
                    location: document.getElementById('location').value,
                    workers: document.getElementById('workers').value,
                    equipment: document.getElementById('equipment').value
                },
                resources: {
                    materials: document.getElementById('materials').value
                },
                remarks: {
                    note: document.getElementById('special_note').value
                },
                // íŒŒì¼ ì²˜ë¦¬ëŠ” ì‹¤ì œë¡œëŠ” FormData ê°ì²´ë¥¼ ì‚¬ìš©í•´ì•¼ í•˜ë‚˜, 
                // ì—¬ê¸°ì„œëŠ” JSON êµ¬ì¡° ì˜ˆì‹œë¥¼ ìœ„í•´ ë©”íƒ€ë°ì´í„°ë§Œ í¬í•¨í•œë‹¤ê³  ê°€ì •
                attachments: {
                    file_count: document.getElementById('file-input').files.length
                }
            };

            console.log("ğŸ“¤ [Client] ì „ì†¡í•  ë°ì´í„° íŒ¨í‚¤ì§• ì™„ë£Œ:", inputData);

            // 3. ì„œë²„ í†µì‹  (Fetch API)
            try {
                // SERVER_URLì´ ë¹„ì–´ìˆìœ¼ë¯€ë¡œ ì—¬ê¸°ì„œ fetchëŠ” ì‹¤íŒ¨í•©ë‹ˆë‹¤.
                // ì‹¤ì œ êµ¬í˜„ ì‹œ: ${SERVER_URL}/api/reports/generate ì™€ ê°™ì´ ì—”ë“œí¬ì¸íŠ¸ ì§€ì •
                const response = await fetch(`${SERVER_URL}/api/generate-report`, {
                    method: 'POST',
                    headers: {
                        'Content-Type': 'application/json',
                        // í•„ìš” ì‹œ ì¸ì¦ í† í° ì¶”ê°€: 'Authorization': 'Bearer ...'
                    },
                    body: JSON.stringify(inputData) // ë°ì´í„°ë¥¼ JSON ë¬¸ìì—´ë¡œ ë³€í™˜í•˜ì—¬ ì „ì†¡
                });

                if (!response.ok) {
                    throw new Error(`HTTP error! status: ${response.status}`);
                }

                const result = await response.json();
                console.log("âœ… [Server] ì‘ë‹µ ì„±ê³µ:", result);
                alert("Day-Con: ë³´ê³ ì„œ ìƒì„±ì´ ì™„ë£Œë˜ì—ˆìŠµë‹ˆë‹¤!");

            } catch (error) {
                // 4. ì—ëŸ¬ í•¸ë“¤ë§ (í˜„ì¬ SERVER_URLì´ ì—†ìœ¼ë¯€ë¡œ ì´ìª½ ë¡œì§ì´ ì‹¤í–‰ë¨)
                console.error("âš ï¸ [Error] ì„œë²„ í†µì‹  ì¤‘ ì˜¤ë¥˜ ë°œìƒ:", error);
                
                // ì‚¬ìš©ì ê²½í—˜ì„ ìœ„í•´ ê°€ì§œ ì„±ê³µ ë©”ì‹œì§€ (ê°œë°œ ë‹¨ê³„ìš©) 
                // ì‹¤ì œ ë°°í¬ ì‹œì—ëŠ” ì œê±°í•˜ê±°ë‚˜ ì ì ˆí•œ ì—ëŸ¬ ë©”ì‹œì§€ë¡œ ë³€ê²½í•´ì•¼ í•¨
                setTimeout(() => {
                    loadingOverlay.style.display = 'none';
                    alert(`[Day-Con ê°œë°œì ëª¨ë“œ ì•Œë¦¼]\nì„œë²„ ì£¼ì†Œ(SERVER_URL)ê°€ ì„¤ì •ë˜ì§€ ì•Šì•„ í†µì‹ ì— ì‹¤íŒ¨í–ˆìŠµë‹ˆë‹¤.\n\ní•˜ì§€ë§Œ ì „ì†¡í•˜ë ¤ë˜ ë°ì´í„°ëŠ” ì½˜ì†”(F12)ì—ì„œ í™•ì¸í•  ìˆ˜ ìˆìŠµë‹ˆë‹¤.\n\n(Error: ${error.message})`);
                }, 1000); // 1ì´ˆ ë’¤ ì•Œë¦¼
            }
        }
    </script>
</body>
</html>